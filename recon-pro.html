
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‚ö° RECON PRO - 3-Step Smart Reconnaissance</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Fira+Code:wght@400;500&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            font-family: 'Inter', sans-serif;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        /* Header */
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .header h1 {
            font-size: 32px;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .header h1 span {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-size: 14px;
            padding: 4px 12px;
            border-radius: 20px;
            -webkit-text-fill-color: white;
        }

        .header p {
            color: #666;
            font-size: 16px;
            line-height: 1.6;
        }

        .workflow-badges {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .workflow-badge {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 8px 20px;
            border-radius: 30px;
            font-size: 14px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .workflow-badge.step1 { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
        .workflow-badge.step2 { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); }
        .workflow-badge.step3 { background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); }

        /* Scan Panel */
        .scan-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        .input-group {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .input-group input {
            flex: 1;
            background: white;
            border: 2px solid #e0e0e0;
            color: #333;
            padding: 15px 20px;
            font-size: 16px;
            border-radius: 12px;
            font-family: 'Fira Code', monospace;
            transition: all 0.3s;
        }

        .input-group input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .input-group button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            color: white;
            padding: 15px 40px;
            font-size: 16px;
            font-weight: 600;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .input-group button:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 30px rgba(102, 126, 234, 0.4);
        }

        .input-group button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* Step Progress */
        .steps-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 25px;
        }

        .step-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s;
        }

        .step-card.active {
            transform: scale(1.02);
            box-shadow: 0 20px 40px rgba(102, 126, 234, 0.3);
            border: 2px solid #667eea;
        }

        .step-card.completed {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: white;
        }

        .step-number {
            font-size: 14px;
            font-weight: 600;
            color: #667eea;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .step-card.completed .step-number {
            color: white;
        }

        .step-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .step-command {
            background: #f5f5f5;
            padding: 10px 15px;
            border-radius: 10px;
            font-family: 'Fira Code', monospace;
            font-size: 13px;
            color: #333;
            margin: 15px 0;
            border-left: 3px solid #667eea;
        }

        .step-card.completed .step-command {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border-left-color: white;
        }

        .step-stats {
            display: flex;
            justify-content: space-between;
            color: #666;
            font-size: 14px;
            margin-top: 15px;
        }

        .step-card.completed .step-stats {
            color: white;
        }

        .stat-highlight {
            font-weight: 700;
            color: #667eea;
        }

        .step-card.completed .stat-highlight {
            color: white;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 25px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .stat-icon {
            font-size: 32px;
            margin-bottom: 10px;
        }

        .stat-value {
            font-size: 36px;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            line-height: 1.2;
        }

        .stat-label {
            color: #666;
            font-size: 14px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stat-card.critical .stat-value {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Progress Bar */
        .progress-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .progress-bar {
            height: 12px;
            background: #e0e0e0;
            border-radius: 6px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.3s;
            border-radius: 6px;
        }

        .progress-status {
            color: #666;
            font-size: 14px;
            font-family: 'Fira Code', monospace;
        }

        /* Tabs */
        .tabs-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 15px;
        }

        .tab {
            padding: 10px 25px;
            cursor: pointer;
            border-radius: 30px;
            font-weight: 500;
            transition: all 0.3s;
            color: #666;
        }

        .tab:hover {
            background: #f5f5f5;
        }

        .tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        /* Results Panel */
        .results-panel {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
        }

        .panel-header {
            background: #f8f9fa;
            padding: 20px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .panel-header h3 {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .badge {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 5px 15px;
            border-radius: 30px;
            font-size: 14px;
            font-weight: 500;
        }

        .badge.critical {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .panel-content {
            max-height: 500px;
            overflow-y: auto;
            padding: 15px;
        }

        /* URL Items */
        .url-item {
            background: #f8f9fa;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.2s;
            border-left: 4px solid transparent;
        }

        .url-item:hover {
            background: white;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transform: translateX(5px);
        }

        .url-item.sensitive {
            border-left-color: #f5576c;
        }

        .url-item.file {
            border-left-color: #4facfe;
        }

        .url-item.js {
            border-left-color: #f093fb;
        }

        .url-meta {
            display: flex;
            gap: 15px;
            margin-top: 10px;
            font-size: 12px;
        }

        .url-tag {
            background: white;
            padding: 3px 10px;
            border-radius: 15px;
            border: 1px solid #e0e0e0;
            color: #666;
        }

        .url-tag.highlight {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
        }

        /* Secret Items */
        .secret-item {
            background: linear-gradient(135deg, #fff5f5 0%, #fff0f0 100%);
            border: 1px solid #f5576c;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
        }

        .secret-type {
            display: inline-block;
            background: #f5576c;
            color: white;
            padding: 3px 12px;
            border-radius: 15px;
            font-size: 11px;
            font-weight: 600;
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        .secret-url {
            color: #333;
            font-family: 'Fira Code', monospace;
            font-size: 12px;
            word-break: break-all;
            cursor: pointer;
        }

        .secret-url:hover {
            color: #667eea;
            text-decoration: underline;
        }

        /* Command Output */
        .command-output {
            background: #1e1e2f;
            color: #00ff9d;
            padding: 15px;
            border-radius: 10px;
            font-family: 'Fira Code', monospace;
            font-size: 12px;
            margin-top: 15px;
            max-height: 200px;
            overflow-y: auto;
        }

        .command-line {
            color: #ffaa00;
            margin-bottom: 5px;
        }

        .command-result {
            color: #00ff9d;
            margin-left: 20px;
            margin-bottom: 10px;
        }

        /* Animations */
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        .loading {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid #667eea;
            border-top-color: transparent;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #999;
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 15px;
            opacity: 0.5;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>
                ‚ö° RECON PRO - 3-Step Smart Reconnaissance
                <span>v3.0</span>
            </h1>
            <p>Most bug hunters stop at URLs. Real impact comes from what those URLs expose.<br>
            This workflow combines: high-risk file extensions + real-world secret patterns + automated URL discovery</p>
            <div class="workflow-badges">
                <div class="workflow-badge step1">üì° Step 1: Asset Discovery</div>
                <div class="workflow-badge step2">üîó Step 2: URL Extraction</div>
                <div class="workflow-badge step3">üîç Step 3: Smart Grep</div>
            </div>
        </div>

        <!-- Scan Panel -->
        <div class="scan-panel">
            <div class="input-group">
                <input type="text" id="domainInput" placeholder="Enter target domain (e.g., example.com)" value="example.com">
                <button id="scanBtn">‚ñ∂ START 3-STEP RECON</button>
            </div>
        </div>

        <!-- Step Progress Cards -->
        <div class="steps-container" id="stepsContainer">
            <div class="step-card" id="step1">
                <div class="step-number">STEP 01</div>
                <div class="step-title">
                    üì° Asset Discovery
                    <span id="step1Status"></span>
                </div>
                <div class="step-command">subfinder -d example.com | httpx -mc 200,401,403,404</div>
                <div class="step-stats">
                    <span>üîç <span id="step1Domains">0</span> domains found</span>
                    <span>‚úÖ <span id="step1Live">0</span> live</span>
                </div>
            </div>

            <div class="step-card" id="step2">
                <div class="step-number">STEP 02</div>
                <div class="step-title">
                    üîó URL Extraction
                    <span id="step2Status"></span>
                </div>
                <div class="step-command">cat domains.txt | katana | tee urls.txt</div>
                <div class="step-stats">
                    <span>üîó <span id="step2Urls">0</span> URLs extracted</span>
                </div>
            </div>

            <div class="step-card" id="step3">
                <div class="step-number">STEP 03</div>
                <div class="step-title">
                    üîç Smart Grep
                    <span id="step3Status"></span>
                </div>
                <div class="step-command">grep -aiE "\.(zip|rar|tar|gz|config|log|bak|backup|java|old|xlsx|json|pdf|doc|docx|pptx|csv|htaccess|7z)$|(access_key|access_token|api_key|aws_secret)"</div>
                <div class="step-stats">
                    <span>üìÅ <span id="step3Files">0</span> sensitive files</span>
                    <span>üîê <span id="step3Secrets">0</span> secrets</span>
                </div>
            </div>
        </div>

        <!-- Stats Grid -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">üåê</div>
                <div class="stat-value" id="statTotalDomains">0</div>
                <div class="stat-label">Total Domains</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üîó</div>
                <div class="stat-value" id="statTotalUrls">0</div>
                <div class="stat-label">URLs Found</div>
            </div>
            <div class="stat-card critical">
                <div class="stat-icon">üìÅ</div>
                <div class="stat-value" id="statSensitiveFiles">0</div>
                <div class="stat-label">Sensitive Files</div>
            </div>
            <div class="stat-card critical">
                <div class="stat-icon">üîê</div>
                <div class="stat-value" id="statSecrets">0</div>
                <div class="stat-label">Secrets Found</div>
            </div>
        </div>

        <!-- Progress Bar -->
        <div class="progress-container">
            <div class="progress-header">
                <span>Scan Progress</span>
                <span id="progressPercentage">0%</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar"></div>
            </div>
            <div class="progress-status" id="progressStatus">Ready to scan</div>
        </div>

        <!-- Command Output (simulates terminal) -->
        <div class="command-output" id="commandOutput">
            <div class="command-line">$ ./recon-pro --target example.com</div>
            <div class="command-result">‚ö° RECON PRO v3.0 initialized</div>
            <div class="command-result">üîç Ready to scan. Click START to begin...</div>
        </div>

        <!-- Tabs -->
        <div class="tabs-container">
            <div class="tabs">
                <div class="tab active" data-tab="highvalue">üî• High-Value URLs</div>
                <div class="tab" data-tab="sensitive">üìÅ Sensitive Files</div>
                <div class="tab" data-tab="secrets">üîê Secrets</div>
                <div class="tab" data-tab="js">üìú JavaScript Files</div>
                <div class="tab" data-tab="domains">üåê Domains</div>
                <div class="tab" data-tab="all">üìã All URLs</div>
            </div>

            <div class="results-panel">
                <div class="panel-header">
                    <h3 id="panelTitle">üî• High-Value URLs</h3>
                    <span class="badge critical" id="panelCount">0</span>
                </div>
                <div class="panel-content" id="panelContent">
                    <div class="empty-state">
                        <div class="empty-state-icon">üöÄ</div>
                        <div>Click START 3-STEP RECON to begin scanning</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==================== DATA GENERATION ====================
        function generateResults(domain) {
            domain = domain.replace(/^https?:\/\//, '').replace(/\/$/, '');
            
            // Step 1: Asset Discovery - Generate subdomains
            const subdomains = [
                'www', 'mail', 'remote', 'blog', 'webmail', 'server', 'ns1', 'ns2', 
                'smtp', 'secure', 'vpn', 'admin', 'portal', 'support', 'pop', 'pop3',
                'ftp', 'ssh', 'exchange', 'mail2', 'gw', 'proxy', 'test', 'dev',
                'staging', 'stage', 'beta', 'shop', 'store', 'api', 'app', 'demo',
                'media', 'cdn', 'static', 'assets', 'images', 'img', 'video',
                'download', 'downloads', 'files', 'file', 'upload', 'uploads',
                'forum', 'community', 'chat', 'help', 'docs', 'documentation',
                'wiki', 'kb', 'knowledge', 'faq', 'status', 'health', 'monitor',
                'monitoring', 'stats', 'statistics', 'analytics', 'metrics',
                'logs', 'log', 'debug', 'trace', 'internal', 'external',
                'public', 'private', 'auth', 'login', 'signin', 'signup',
                'register', 'account', 'accounts', 'user', 'users', 'profile',
                'profiles', 'member', 'members', 'customer', 'customers',
                'client', 'clients', 'partner', 'partners', 'vendor', 'vendors',
                'backup', 'backups', 'archive', 'archives', 'old', 'new',
                'temp', 'tmp', 'cache', 'cached', 'storage', 'staging',
                'preview', 'preprod', 'production', 'prod', 'development',
                'sandbox', 'playground', 'lab', 'labs', 'testlab',
                'jenkins', 'git', 'gitlab', 'jira', 'confluence', 'wiki',
                'phpmyadmin', 'adminer', 'mysql', 'pma', 'webmin', 'cpanel',
                'kibana', 'elastic', 'grafana', 'prometheus', 'docker', 'k8s',
                'redis', 'memcache', 'mongodb', 'rabbitmq', 'jenkins', 'sonar'
            ];

            const liveDomains = [];
            const allDomains = [domain, `www.${domain}`];
            
            subdomains.forEach(sub => {
                if (Math.random() > 0.3) { // 70% chance of existing
                    const subdomain = `${sub}.${domain}`;
                    allDomains.push(subdomain);
                    if (Math.random() > 0.4) { // 60% chance of being live
                        liveDomains.push({
                            domain: subdomain,
                            status: [200, 401, 403, 404][Math.floor(Math.random() * 4)],
                            ip: `${Math.floor(Math.random() * 256)}.${Math.floor(Math.random() * 256)}.${Math.floor(Math.random() * 256)}.${Math.floor(Math.random() * 256)}`
                        });
                    }
                }
            });

            // Step 2: URL Extraction - Generate URLs
            const paths = [
                '/.env', '/.env.local', '/.env.production', '/.env.development',
                '/.git/config', '/.git/HEAD', '/.git/index',
                '/.aws/credentials', '/.aws/config',
                '/.npmrc', '/.yarnrc', '/.pypirc',
                '/.ssh/id_rsa', '/.ssh/id_dsa', '/.ssh/authorized_keys',
                '/composer.json', '/package.json', '/Gemfile', '/requirements.txt',
                '/wp-config.php', '/configuration.php', '/settings.py',
                '/database.yml', '/application.properties', '/secrets.yml',
                '/.htaccess', '/.htpasswd', '/web.config',
                '/robots.txt', '/sitemap.xml', '/crossdomain.xml',
                '/phpinfo.php', '/info.php', '/test.php', '/php.php',
                '/backup.sql', '/dump.sql', '/db.sql', '/database.sql',
                '/backup.zip', '/backup.tar.gz', '/backup.tgz',
                '/.DS_Store', '/Thumbs.db', '/.directory',
                '/swagger.json', '/swagger.yaml', '/openapi.json', '/api-docs',
                '/graphql', '/graphiql', '/playground', '/voyager',
                '/.well-known/security.txt', '/.well-known/openid-configuration',
                '/server-status', '/server-info', '/status', '/metrics',
                '/actuator', '/actuator/health', '/actuator/info', '/actuator/env',
                '/console', '/h2-console', '/h2', '/h2-console/login.jsp',
                '/api/swagger', '/api/docs', '/api/v1/docs', '/api/v2/docs',
                '/debug', '/debug/', '/debug/pprof', '/debug/vars',
                '/test', '/test/', '/tests', '/testing', '/staging',
                '/private', '/private/', '/internal', '/internal/',
                '/admin', '/admin/', '/administrator', '/admin-console',
                '/backup', '/backup/', '/backups', '/archive',
                '/logs', '/log', '/logging', '/logger',
                '/cache', '/cached', '/tmp', '/temp', '/temp/'
            ];

            const jsPaths = [
                '/static/js/main.js', '/static/js/bundle.js', '/js/app.js',
                '/assets/js/main.js', '/dist/js/app.js', '/build/js/app.js',
                '/public/js/app.js', '/scripts/main.js', '/javascripts/app.js',
                '/static/js/vendor.js', '/js/libs.js', '/js/plugins.js',
                '/assets/js/common.js', '/js/functions.js', '/js/analytics.js',
                '/tracking.js', '/gtag.js', '/analytics.js', '/metrics.js'
            ];

            const urls = [];
            const jsFiles = [];

            // Generate URLs from domains
            allDomains.forEach(domain => {
                // Add paths
                paths.forEach(path => {
                    if (Math.random() > 0.5) {
                        urls.push(`https://${domain}${path}`);
                        urls.push(`http://${domain}${path}`);
                    }
                });

                // Add JS files
                jsPaths.forEach(path => {
                    if (Math.random() > 0.7) {
                        const jsUrl = `https://${domain}${path}`;
                        jsFiles.push({
                            url: jsUrl,
                            domain: domain
                        });
                        urls.push(jsUrl);
                    }
                });

                // Add API endpoints
                if (Math.random() > 0.6) {
                    urls.push(`https://${domain}/api/v1/users`);
                    urls.push(`https://${domain}/api/v2/data`);
                    urls.push(`https://${domain}/graphql`);
                    urls.push(`https://${domain}/rest/v1/`);
                }
            });

            // Add URLs with secrets
            const secretParams = [
                '?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c',
                '?api_key=AKIAIOSFODNN7EXAMPLE',
                '?password=admin123',
                '?secret=sk_live_1234567890abcdefghijklmnopqrstuvwxyz',
                '?access_token=ghp_abcdefghijklmnopqrstuvwxyz1234567890',
                '?auth=EAACEdEose0cBA1234567890abcdef',
                '?token=xoxb-1234567890-abcdefghijklmnopqrstuvwxyz',
                '?aws_secret=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY',
                '?private_key=-----BEGIN RSA PRIVATE KEY-----'
            ];

            allDomains.slice(0, 10).forEach(domain => {
                secretParams.forEach(param => {
                    urls.push(`https://${domain}/api/data${param}`);
                    urls.push(`https://${domain}/auth/login${param}`);
                    urls.push(`https://${domain}/admin${param}`);
                });
            });

            // Remove duplicates
            const uniqueUrls = [...new Set(urls)];

            // Step 3: Smart Grep - Find sensitive files and secrets
            const sensitiveExtensions = [
                'zip', 'rar', 'tar', 'gz', '7z', 'bz2', 'xz', 'tgz',
                'backup', 'bak', 'bck', 'old', 'orig', 'copy',
                'env', 'config', 'conf', 'cfg', 'ini', 'yml', 'yaml', 'json',
                'xml', 'toml', 'properties', 'plist', 'cnf', 'reg',
                'log', 'logs', 'debug', 'trace', 'audit', 'out', 'err',
                'sql', 'db', 'sqlite', 'sqlite3', 'mdb', 'dbf', 'dmp', 'dump',
                'pem', 'key', 'crt', 'cer', 'p12', 'pfx', 'jks', 'keystore',
                'asc', 'gpg', 'pgp', 'pub',
                'htaccess', 'htpasswd', 'git', 'svn', 'gitignore',
                'dockerignore', 'npmignore', 'bower.json', 'composer.json',
                'package.json', 'package-lock.json', 'yarn.lock', 'Gemfile',
                'requirements.txt', 'Pipfile', 'swagger', 'openapi',
                'pdf', 'doc', 'docx', 'xls', 'xlsx', 'ppt', 'pptx', 'txt', 'csv'
            ];

            const secretPatterns = [
                { name: 'AWS Access Key', pattern: /AKIA[0-9A-Z]{16}/ },
                { name: 'AWS Secret Key', pattern: /wJalrXUtnFEMI\/K7MDENG\/bPxRfiCYEXAMPLEKEY/ },
                { name: 'Google API Key', pattern: /AIza[0-9A-Za-z\-_]{35}/ },
                { name: 'GitHub Token', pattern: /ghp_[a-zA-Z0-9]{36}/ },
                { name: 'Facebook Token', pattern: /EAACEdEose0cBA[0-9A-Za-z]+/ },
                { name: 'Slack Token', pattern: /xox[baprs]-[0-9a-zA-Z]{10,48}/ },
                { name: 'Stripe Key', pattern: /sk_live_[0-9a-zA-Z]{24}/ },
                { name: 'JWT Token', pattern: /eyJ[a-zA-Z0-9_-]+\.[a-zA-Z0-9_-]+\.[a-zA-Z0-9_-]+/ },
                { name: 'Password', pattern: /[?&]password=[^&\s]+/i },
                { name: 'Token', pattern: /[?&]token=[^&\s]+/i },
                { name: 'API Key', pattern: /[?&]api[_-]?key=[^&\s]+/i },
                { name: 'Secret', pattern: /[?&]secret=[^&\s]+/i },
                { name: 'Private Key', pattern: /-----BEGIN RSA PRIVATE KEY-----/ },
                { name: 'MongoDB', pattern: /mongodb(?:\+srv)?:\/\/[^\s]+/ },
                { name: 'MySQL', pattern: /mysql:\/\/[^\s]+/ },
                { name: 'Redis', pattern: /redis:\/\/[^\s]+/ }
            ];

            const sensitiveFiles = [];
            const secrets = [];
            const highValueUrls = [];

            uniqueUrls.forEach(url => {
                const urlPath = url.split('?')[0];
                const ext = urlPath.split('.').pop()?.toLowerCase();
                
                if (ext && sensitiveExtensions.includes(ext)) {
                    sensitiveFiles.push({ url, extension: ext });
                    highValueUrls.push(url);
                }

                for (const pattern of secretPatterns) {
                    if (pattern.pattern.test(url)) {
                        secrets.push({ url, type: pattern.name });
                        highValueUrls.push(url);
                        break;
                    }
                }
            });

            // Deduplicate
            const uniqueSensitive = [...new Map(sensitiveFiles.map(item => [item.url, item])).values()];
            const uniqueSecrets = [...new Map(secrets.map(item => [item.url, item])).values()];
            const uniqueHighValue = [...new Set(highValueUrls)];
            const uniqueJsFiles = [...new Map(jsFiles.map(item => [item.url, item])).values()];

            return {
                domain,
                timestamp: new Date().toLocaleString(),
                steps: {
                    step1: {
                        domains: allDomains.length,
                        live: liveDomains.length
                    },
                    step2: {
                        urls: uniqueUrls.length,
                        jsFiles: uniqueJsFiles.length
                    },
                    step3: {
                        sensitiveFiles: uniqueSensitive.length,
                        secrets: uniqueSecrets.length,
                        highValue: uniqueHighValue.length
                    }
                },
                data: {
                    domains: allDomains,
                    liveDomains: liveDomains,
                    allUrls: uniqueUrls,
                    jsFiles: uniqueJsFiles,
                    sensitiveFiles: uniqueSensitive,
                    secrets: uniqueSecrets,
                    highValueUrls: uniqueHighValue
                }
            };
        }

        // ==================== UI FUNCTIONS ====================
        let currentResults = null;
        let activeTab = 'highvalue';
        let scanInterval;

        // Tab switching
        const tabs = document.querySelectorAll('.tab');
        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                tabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                activeTab = tab.dataset.tab;
                if (currentResults) {
                    updatePanel(activeTab);
                }
            });
        });

        function updatePanel(tab) {
            if (!currentResults) return;

            const panelTitle = document.getElementById('panelTitle');
            const panelCount = document.getElementById('panelCount');
            const panelContent = document.getElementById('panelContent');

            let items = [];
            let title = '';

            switch(tab) {
                case 'highvalue':
                    items = currentResults.data.highValueUrls;
                    title = 'üî• High-Value URLs';
                    panelContent.innerHTML = items.length > 0 
                        ? items.map(url => `
                            <div class="url-item sensitive" onclick="window.open('${url}', '_blank')">
                                ${url}
                                <div class="url-meta">
                                    <span class="url-tag highlight">high-value</span>
                                </div>
                            </div>
                        `).join('')
                        : '<div class="empty-state"><div class="empty-state-icon">üîç</div>No high-value URLs found</div>';
                    break;

                case 'sensitive':
                    items = currentResults.data.sensitiveFiles;
                    title = 'üìÅ Sensitive Files';
                    panelContent.innerHTML = items.length > 0 
                        ? items.map(file => `
                            <div class="url-item file" onclick="window.open('${file.url}', '_blank')">
                                ${file.url}
                                <div class="url-meta">
                                    <span class="url-tag">.${file.extension}</span>
                                </div>
                            </div>
                        `).join('')
                        : '<div class="empty-state"><div class="empty-state-icon">üìÅ</div>No sensitive files found</div>';
                    break;

                case 'secrets':
                    items = currentResults.data.secrets;
                    title = 'üîê Secrets Found';
                    panelContent.innerHTML = items.length > 0 
                        ? items.map(secret => `
                            <div class="secret-item">
                                <span class="secret-type">${secret.type}</span>
                                <div class="secret-url" onclick="window.open('${secret.url}', '_blank')">${secret.url}</div>
                            </div>
                        `).join('')
                        : '<div class="empty-state"><div class="empty-state-icon">üîê</div>No secrets found</div>';
                    break;

                case 'js':
                    items = currentResults.data.jsFiles;
                    title = 'üìú JavaScript Files';
                    panelContent.innerHTML = items.length > 0 
                        ? items.map(js => `
                            <div class="url-item js" onclick="window.open('${js.url}', '_blank')">
                                ${js.url}
                                <div class="url-meta">
                                    <span class="url-tag">javascript</span>
                                </div>
                            </div>
                        `).join('')
                        : '<div class="empty-state"><div class="empty-state-icon">üìú</div>No JavaScript files found</div>';
                    break;

                case 'domains':
                    items = currentResults.data.domains;
                    title = 'üåê Domains Found';
                    panelContent.innerHTML = items.length > 0 
                        ? items.map(domain => `
                            <div class="url-item" onclick="window.open('https://${domain}', '_blank')">
                                ${domain}
                            </div>
                        `).join('')
                        : '<div class="empty-state"><div class="empty-state-icon">üåê</div>No domains found</div>';
                    break;

                case 'all':
                    items = currentResults.data.allUrls;
                    title = 'üìã All URLs';
                    panelContent.innerHTML = items.length > 0 
                        ? items.map(url => `
                            <div class="url-item" onclick="window.open('${url}', '_blank')">
                                ${url}
                            </div>
                        `).join('')
                        : '<div class="empty-state"><div class="empty-state-icon">üìã</div>No URLs found</div>';
                    break;
            }

            panelTitle.textContent = title;
            panelCount.textContent = items.length;
            panelCount.className = (tab === 'highvalue' || tab === 'secrets') ? 'badge critical' : 'badge';
        }

        function updateStats(results) {
            // Update step cards
            document.getElementById('step1Domains').textContent = results.steps.step1.domains;
            document.getElementById('step1Live').textContent = results.steps.step1.live;
            document.getElementById('step2Urls').textContent = results.steps.step2.urls;
            document.getElementById('step3Files').textContent = results.steps.step3.sensitiveFiles;
            document.getElementById('step3Secrets').textContent = results.steps.step3.secrets;

            // Update main stats
            document.getElementById('statTotalDomains').textContent = results.steps.step1.domains;
            document.getElementById('statTotalUrls').textContent = results.steps.step2.urls;
            document.getElementById('statSensitiveFiles').textContent = results.steps.step3.sensitiveFiles;
            document.getElementById('statSecrets').textContent = results.steps.step3.secrets;
        }

        function updateCommandOutput(message, type = 'info') {
            const output = document.getElementById('commandOutput');
            const line = document.createElement('div');
            line.className = type === 'command' ? 'command-line' : 'command-result';
            line.textContent = type === 'command' ? `$ ${message}` : message;
            output.appendChild(line);
            output.scrollTop = output.scrollHeight;
            
            // Keep only last 20 lines
            while (output.children.length > 20) {
                output.removeChild(output.children[0]);
            }
        }

        function simulateScan(domain) {
            const steps = ['step1', 'step2', 'step3'];
            let currentStep = 0;
            
            // Reset step cards
            steps.forEach(step => {
                document.getElementById(step).classList.remove('completed', 'active');
            });

            updateCommandOutput(`./recon-pro --target ${domain}`, 'command');
            updateCommandOutput(`‚ö° Starting 3-step reconnaissance on ${domain}...`);

            scanInterval = setInterval(() => {
                if (currentStep < steps.length) {
                    // Mark current step as active
                    document.getElementById(steps[currentStep]).classList.add('active');
                    
                    // Update progress
                    const progress = ((currentStep + 1) / 3) * 100;
                    document.getElementById('progressBar').style.width = progress + '%';
                    document.getElementById('progressPercentage').textContent = Math.round(progress) + '%';
                    
                    // Step-specific messages
                    switch(currentStep) {
                        case 0:
                            document.getElementById('progressStatus').textContent = 'Step 1: Asset Discovery in progress...';
                            updateCommandOutput('üì° Running: subfinder -d ' + domain + ' | httpx -mc 200,401,403,404');
                            break;
                        case 1:
                            document.getElementById('progressStatus').textContent = 'Step 2: URL Extraction in progress...';
                            updateCommandOutput('üîó Running: cat domains.txt | katana');
                            break;
                        case 2:
                            document.getElementById('progressStatus').textContent = 'Step 3: Smart Grep in progress...';
                            updateCommandOutput('üîç Running: grep -aiE "sensitive patterns" urls.txt');
                            break;
                    }
                    
                    currentStep++;
                } else {
                    // Scan complete
                    clearInterval(scanInterval);
                    
                    // Generate results
                    currentResults = generateResults(domain);
                    
                    // Mark all steps as completed
                    steps.forEach(step => {
                        document.getElementById(step).classList.remove('active');
                        document.getElementById(step).classList.add('completed');
                    });
                    
                    // Update UI
                    document.getElementById('progressBar').style.width = '100%';
                    document.getElementById('progressPercentage').textContent = '100%';
                    document.getElementById('progressStatus').textContent = 'Scan Complete!';
                    
                    updateStats(currentResults);
                    updatePanel(activeTab);
                    
                    updateCommandOutput('‚úÖ Scan complete!');
                    updateCommandOutput(`üìä Found ${currentResults.steps.step3.sensitiveFiles} sensitive files and ${currentResults.steps.step3.secrets} secrets`);
                    
                    document.getElementById('scanBtn').disabled = false;
                    document.getElementById('scanBtn').innerHTML = '‚ñ∂ START 3-STEP RECON';
                }
            }, 1000);
        }

        // Scan button click
        document.getElementById('scanBtn').addEventListener('click', () => {
            const domain = document.getElementById('domainInput').value.trim() || 'example.com';
            
            // Disable button
            document.getElementById('scanBtn').disabled = true;
            document.getElementById('scanBtn').innerHTML = '<span class="loading"></span> SCANNING...';
            
            // Clear previous results
            document.getElementById('panelContent').innerHTML = '<div class="empty-state"><div class="loading"></div> Scanning in progress...</div>';
            
            // Start simulation
            simulateScan(domain);
        });

        // Enter key
        document.getElementById('domainInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                document.getElementById('scanBtn').click();
            }
        });

        // Load example on startup
        window.addEventListener('load', () => {
            setTimeout(() => {
                document.getElementById('scanBtn').click();
            }, 500);
        });
    </script>
</body>
</html>
